<html><head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono&display=swap">
  <script src="https://kit.fontawesome.com/1e36e2dfe7.js" crossorigin="anonymous"></script>
  <script src="jquery.min.js"></script>
  <script src="bootstrap.min.js"></script>
  <script src="highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="fuse.min.js"></script>
  <script src="dox2web.js"></script>
  <title>Visionary Render Programming Guide: Using the Script Event System</title>
</head>
<body><a class="main-logo" href="https://www.virtalis.com" target="_blank" rel="noopener noreferrer"></a>
<nav class="navbar navbar-inverse navbar-fixed-top navbar-lower" role="navigation">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-nav-contents" aria-expanded="false">
    <span class="sr-only">Toggle navigation</span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <div class="collapse navbar-collapse" id="bs-nav-contents"><ul class="nav navbar-nav" id="main-menu">
    <li><a href="index.html">Overview</a></li>
    <li><a href="pages.html">Contents</a></li>
    <li><a href="modules.html">API</a></li>
  </ul>
</nav>
<div class="shove"><div class="container-fluid"><div class="col-sm-10 col-sm-push-2 main"><nav aria-label = "breadcrumb"><ol class="breadcrumb forward-slash"><li class = "breadcrumb-item "><a href = "index.html">Overview</a></li><li class = "breadcrumb-item"><a href="getting_started.html">Getting Started</a></li><li class = "breadcrumb-item active">Using the Script Event System</li></ol></nav><div class="page-toc"><ol><li><strong>Contents</strong></li><li><a href="#">Using the Script Event System</a></li><ol><li><a href="#GjZhTR76wgVB">Guards</a></li><li><a href="#ckL4UFJzt8L4">Registers</a></li><li><a href="#M6xojsygBltK">Events</a></li></ol></div><h1>Using the Script Event System</h1><p>This page gives an introduction to the script event system and registers.</p><p>Visionary Render can automatically generate common scripts using Events. To create an Event, right-click on a node in the tree and select <code>Create</code> > <code>Event</code> from the context menu. A default Key Press Event will be added to your scene as in the image below.</p><p><img src="script_events.png"></img></p><p>An Event consists of an EventHandler node with a child EventScript node. To edit the script, show the properties of the EventHandler node and click on the Script cell in the Action column. This will open the script in the Script Editor.</p><p><div class="alert alert-success"><p><strong>Note</strong></p><p><p>Visionary Render provides a drag and drop interface to automatically generate some basic script actions. These are covered in the Visionary Render User Manual.</p></p></div><h2 class="anchor" id="GjZhTR76wgVB">Guards</h2></p><p>Guards permit you to set an extra condition to be met before a script is executed. A Guard may be one of the following:</p><p><ul><li><p>A key on the keyboard (modifiers can be used, e.g. <code>Ctrl</code>, <code>Alt</code>, <code>Shift</code>).</p></li><li><p>A time value in seconds.</p></li><li><p>An Assembly.</p></li></ul></p><p><h2 class="anchor" id="ckL4UFJzt8L4">Registers</h2></p><p>Registers are global variables that can be accessed from your scripts. They appear as an autocomplete list when you type <code>_</code> into the Script Editor. The following table describes the available registers:</p><p><dl><dd><div class="table-responsive"><table class="table table-striped table-bordered"><thead><tr><th><p>Register </p></th><th><p>Type </p></th><th><p>Description  </p></th></tr></thead><tbody><tr><td><p><code>__Event</code></p></td><td><p>vrnode </p></td><td><p>The event node that was triggered (available in all events). </p></td></tr><tr><td><p><code>__Gesture</code></p></td><td><p>string </p></td><td><p>The name of the gesture that was made. </p></td></tr><tr><td><p><code>__Hand</code></p></td><td><p>boolean </p></td><td><p>The hand that triggered the event (<code>right hand = true</code>, <code>left hand = false</code>). </p></td></tr><tr><td><p><code>__KeyCode</code></p></td><td><p>number </p></td><td><p>The value of the key that was pressed. Tracker buttons start at <code>1000</code>, mouse buttons start at <code>2000</code>. </p></td></tr><tr><td><p><code>__KeyState</code></p></td><td><p>number </p></td><td><p>Whether the key in <code>__KeyCode</code> was pressed or released (<code>1 = pressed</code>). </p></td></tr><tr><td><p><code>__Other</code></p></td><td><p>vrnode </p></td><td><p>Event specific node. </p></td></tr><tr><td><p><code>__Pose</code></p></td><td><p>string </p></td><td><p>The name of the pose that was made. </p></td></tr><tr><td><p><code>__PoseState</code></p></td><td><p>boolean </p></td><td><p>The state of the pose (<code>entered = true</code>, <code>exited = false</code>). </p></td></tr><tr><td><p><code>__Script</code></p></td><td><p>vrnode </p></td><td><p>The script node containing the code being executed. This is available in all events. </p></td></tr><tr><td><p><code>__Self</code></p></td><td><p>vrnode </p></td><td><p>The node that the event node is attached to (e.g. an Assembly). This is available in all events. </p></td></tr><tr><td><p><code>__Time</code></p></td><td><p>number </p></td><td><p>The total number of seconds since the application started. This is available in all events. </p></td></tr><tr><td><p><code>__TimeDelta</code></p></td><td><p>number </p></td><td><p>The time in seconds since the last call to the event. </p></td></tr><tr><td><p><code>__User</code></p></td><td><p>vrnode </p></td><td><p>The user who triggered the event. This is available in all events. </p></td></tr></tbody></table></div></dd></dl><h2 class="anchor" id="M6xojsygBltK">Events</h2></p><p>There are various types of event that can trigger a script to execute. The table below lists the available events, and which event-specific registers are set. References to "the node" refer to the node to which the EventHandler is attached. The following types of event can be fired:</p><p><dl><dd><div class="table-responsive"><table class="table table-striped table-bordered"><thead><tr><th><p>Event </p></th><th><p>Registers </p></th><th><p>Description  </p></th></tr></thead><tbody><tr><td><p>Activate </p></td><td><p><code>__Other</code></p></td><td><p>Fired when <code><a href="group__api__lua.html#1ga8e87277025a56b7c7265f65cae9b43de" title="Invokes the Activate event of a Node optionally setting the __Other register">vrActivate</a></code> is called. The caller of <code><a href="group__api__lua.html#1ga8e87277025a56b7c7265f65cae9b43de" title="Invokes the Activate event of a Node optionally setting the __Other register">vrActivate</a></code> can set the value of <code>__Other</code> to whatever is required inside this event. It is also triggered by double clicking on some node types in the tree. </p></td></tr><tr><td><p>Break </p></td><td><p><code>__Other</code></p></td><td><p>Fired when two objects stop touching each other in the scene. <code>__Self</code> is this object, <code>__Other</code> is the object that it touched. The guard condition can be set to an Assembly to only fire Break events for that Assembly instead of any node in the scene. Note: you’ll need to add a Collision node to <code>__Self</code> for this event to be fired. </p></td></tr><tr><td><p>Click </p></td><td><p></p></td><td><p>Fired when a 3D GUI item receives a full click (i.e. a press followed by a release). </p></td></tr><tr><td><p>Create </p></td><td><p></p></td><td><p>Fired when the node is created, loaded from file, or when the event script is compiled. </p></td></tr><tr><td><p>Double Click </p></td><td><p></p></td><td><p>Fired when a 3D GUI item receives a double click. </p></td></tr><tr><td><p>Enter </p></td><td><p></p></td><td><p>Fired when a fly-to operation arrives at the node. </p></td></tr><tr><td><p>Gesture Activated </p></td><td><p><code>__Gesture</code></p></td><td><p>Fired when a gesture is made that matches one of the recorded ones. </p></td></tr><tr><td><p>Key Press </p></td><td><p><code>__KeyCode</code>, <code>__KeyState</code></p></td><td><p>Fired when a key on the keyboard is pressed, or the mouse is clicked, or a tracker button is pressed. </p></td></tr><tr><td><p>Key Release </p></td><td><p><code>__KeyCode</code>, <code>__KeyState</code></p></td><td><p>Fired when a key, mouse, or tracker button is released. </p></td></tr><tr><td><p>Leave </p></td><td><p></p></td><td><p>Fired when a subsequent fly-to operation flies somewhere else. </p></td></tr><tr><td><p>Move </p></td><td><p></p></td><td><p>Fired when an assembly is moved in the scene. </p></td></tr><tr><td><p>Pose Entered </p></td><td><p><code>__Pose</code>, <code>__PoseState</code></p></td><td><p>Fired when a pose is made. </p></td></tr><tr><td><p>Pose Left </p></td><td><p><code>__Pose</code>, <code>__PoseState</code></p></td><td><p>Fired when a pose is left. </p></td></tr><tr><td><p>Press </p></td><td><p></p></td><td><p>Fired when a 3D GUI item is pressed (i.e. the cursor is held down). </p></td></tr><tr><td><p>Release </p></td><td><p></p></td><td><p>Fired when a 3D GUI item is released. </p></td></tr><tr><td><p>Rename </p></td><td><p></p></td><td><p>Fired when the node is renamed. </p></td></tr><tr><td><p>Sequence </p></td><td><p></p></td><td><p>Fired when the sequencer reaches an event frame. </p></td></tr><tr><td><p>Time Step </p></td><td><p><code>__TimeDelta</code></p></td><td><p>Fired every frame. </p></td></tr><tr><td><p>Toggle </p></td><td><p></p></td><td><p>Fired when a 3D GUI item toggle state changes. </p></td></tr><tr><td><p>Touch </p></td><td><p><code>__Other</code></p></td><td><p>Fired when two objects touch each other in the scene. <code>__Self</code> is this object, <code>__Other</code> is the object that it touched. The guard condition can be set to an Assembly to only fire Touch events for that Assembly instead of any node in the scene. Note: you’ll need to add a Collision node to <code>__Self</code> for this event to be fired. </p></td></tr><tr><td><p>View Deselect </p></td><td><p><code>__Other</code></p></td><td><p>Fired when a node is deselected. <code>__Other</code> contains the view selection node containing the selection. Note: selecting in the Scenes or Developer tree will fire this event twice (once for each view, as the selection is synchronised). </p></td></tr><tr><td><p>View Select </p></td><td><p><code>__Other</code></p></td><td><p>Fired when a node is selected. <code>__Other</code> contains the view selection node containing the selection. Note: selecting in the Scenes or Developer tree will fire this event twice (once for each view, as the selection is synchronised). </p></td></tr></tbody></table></div></dd></dl><div class="alert alert-success"><p><strong>Note</strong></p><p><p>Execution order is undefined for events that are fired together on the same node. The only exception is that Create events are executed before other types of event. </p></p></div></p><hr/><div class="row footer-nav footer-links"><div class="col-sm-4"><p><span class="fas fa-arrow-circle-left" aria-hidden="true"></span>&nbsp;<a href="applua_intro.html">Using the Script Editor</a></p></div><div class="col-sm-4 col-sm-offset-4"><p class="pull-right"><a href="luaplugin_intro.html">Creating a Lua Plugin</a>&nbsp;<span class="fas fa-arrow-circle-right" aria-hidden="true"></span></p></div></div></div><div class="col-sm-2 col-sm-pull-10 "><div class="main-search"><form id="docs-search" autocomplete="off" class="form-horizontal" accept-charset="utf-8"><div class="input-group text-border"><input name="srch-term" id="srch-term" class="form-control" type="text" placeholder="Search"></div></form></div><div id="searchResults"><div class="list-group"><p class="list-group-item">No Results.</p></div></div><div class="list-group list-group-root"><span class="list-group-item show-path"><a href="#side_getting_started" data-toggle="collapse"><i class="fas fa-minus-square list-toggle"></i></a><a href="getting_started.html">Getting Started</a></span><div class="list-group collapse in" id="side_getting_started"><span class="list-group-item"><a href="applua_intro.html">Using the Script Editor</a></span><span class="list-group-item show-path"><a href="eventlua_intro.html">Using the Script Event System</a></span><span class="list-group-item"><a href="luaplugin_intro.html">Creating a Lua Plugin</a></span><span class="list-group-item"><a href="plugin_intro.html">Creating a Native Plugin</a></span><span class="list-group-item"><a href="plugin_wrangle_api.html">Accessing the API</a></span></div><span class="list-group-item"><a href="#side_architecture" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="architecture.html">Architecture</a></span><div class="list-group collapse" id="side_architecture"><span class="list-group-item"><a href="api_diagram.html">API Diagram</a></span><span class="list-group-item"><a href="metanodes.html">Metanodes</a></span><span class="list-group-item"><a href="properties.html">Properties</a></span><span class="list-group-item"><a href="nodes.html">Nodes</a></span><span class="list-group-item"><a href="observers.html">Observers</a></span><span class="list-group-item"><a href="scenegraph.html">Scene Graph</a></span><span class="list-group-item"><a href="plugin_directories.html">Plugin Search Paths</a></span></div><span class="list-group-item"><a href="best_practices.html">Best Practices</a></span><span class="list-group-item"><a href="#side_howto" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="howto.html">How To</a></span><div class="list-group collapse" id="side_howto"><span class="list-group-item"><a href="#side_howto_lua" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="howto_lua.html">Scripts</a></span><div class="list-group collapse" id="side_howto_lua"><span class="list-group-item"><a href="lua_assembly_howto.html">Work with Assembly Nodes</a></span><span class="list-group-item"><a href="lua_visual_howto.html">Work with Visual Nodes</a></span><span class="list-group-item"><a href="lua_light_howto.html">Work with Light Nodes</a></span><span class="list-group-item"><a href="lua_material_howto.html">Work with Material Nodes</a></span><span class="list-group-item"><a href="lua_lodgeo_howto.html">Work with Level of Detail and GeoGroup Nodes</a></span><span class="list-group-item"><a href="lua_sequence_howto.html">Work with Sequence Nodes</a></span><span class="list-group-item"><a href="lua_audio_howto.html">Work with Audio Nodes</a></span><span class="list-group-item"><a href="lua_video_howto.html">Work with Movie Nodes</a></span><span class="list-group-item"><a href="lua_metadata_howto.html">Work with Metadata and Attribute Nodes</a></span><span class="list-group-item"><a href="lua_settings_howto.html">Work with Settings Nodes</a></span><span class="list-group-item"><a href="lua_observers_howto.html">Work with Observers</a></span></div><span class="list-group-item"><a href="#side_howto_plugins" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="howto_plugins.html">Plugins</a></span><div class="list-group collapse" id="side_howto_plugins"><span class="list-group-item"><a href="importer_howto.html">Provide a Data Importer</a></span><span class="list-group-item"><a href="exporter_howto.html">Provide a Data Exporter</a></span><span class="list-group-item"><a href="context_menu_howto.html">Add a Context Menu</a></span><span class="list-group-item"><a href="ffi_howto.html">Use the Foreign Function Interface (FFI)</a></span><span class="list-group-item"><a href="luafunc_howto.html">Provide a Lua Function</a></span><span class="list-group-item"><a href="define_metanode_howto.html">Define a Custom MetaNode</a></span><span class="list-group-item"><a href="update_howto.html">Implement an Update Function</a></span><span class="list-group-item"><a href="observer_howto.html">Implement an Observer</a></span><span class="list-group-item"><a href="logging_howto.html">Write to the Application Log</a></span><span class="list-group-item"><a href="dialog_howto.html">Present a Modal Dialog</a></span><span class="list-group-item"><a href="progress_howto.html">Update the Loading Screen</a></span></div></div><span class="list-group-item"><a href="#side_advanced" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="advanced.html">Advanced Topics</a></span><div class="list-group collapse" id="side_advanced"><span class="list-group-item"><a href="advanced_appcommands.html">Application Commands</a></span><span class="list-group-item"><a href="advanced_semantics.html">Semantics</a></span><span class="list-group-item"><a href="advanced_metanode_versioning.html">Metanode Versioning</a></span><span class="list-group-item"><a href="dynamic_loading.html">Enabling/Disabling Plugins at Runtime</a></span><span class="list-group-item"><a href="lua_coroutines.html">Coroutines in Lua Plugins</a></span><span class="list-group-item"><a href="lua_odbc.html">Using LuaSQL for ODBC Connections</a></span><span class="list-group-item"><a href="lua_com.html">Reference External Data Using the COM</a></span><span class="list-group-item"><a href="terminating_long_scripts.html">Terminating Long Scripts</a></span><span class="list-group-item"><a href="plugin_depends.html">Plugin Dependencies</a></span><span class="list-group-item"><a href="surface_shader_intro.html">Writing Surface Shaders</a></span><span class="list-group-item"><a href="view_shader_intro.html">Writing View Shaders</a></span></div><span class="list-group-item"><a href="#side_changes" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="changes.html">Changelog</a></span><div class="list-group collapse" id="side_changes"><span class="list-group-item"><a href="v2023_2_to_v2024_1.html">New in 2024.1</a></span><span class="list-group-item"><a href="v2023_1_to_v2023_2.html">New in 2023.2</a></span><span class="list-group-item"><a href="v2021_2_to_v2021_3.html">New in 2021.3</a></span><span class="list-group-item"><a href="v2021_1_to_v2021_2.html">New in 2021.2</a></span><span class="list-group-item"><a href="v2020_2_to_v2021_1.html">New in 2021.1</a></span><span class="list-group-item"><a href="v2020_1_to_v2020_2.html">New in 2020.2</a></span><span class="list-group-item"><a href="v2019_3_to_v2020_1.html">New in 2020.1</a></span><span class="list-group-item"><a href="v2019_2_to_v2019_3.html">New in 2019.3</a></span><span class="list-group-item"><a href="v22_to_v2019_2.html">New in 2019.2</a></span><span class="list-group-item"><a href="v21_to_v22.html">New in 2.2.0</a></span><span class="list-group-item"><a href="v20_to_v21.html">New in 2.1.0</a></span><span class="list-group-item"><a href="#side_v13x_to_v2" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="v13x_to_v2.html">New in 2.0.0</a></span><div class="list-group collapse" id="side_v13x_to_v2"><span class="list-group-item"><a href="v13x_200_pivots.html">Pivot API Changes</a></span><span class="list-group-item"><a href="v13x_200_lua_co.html">Lua Event Coroutines</a></span><span class="list-group-item"><a href="v13x_200_lua_observers.html">Lua Observers</a></span></div></div><span class="list-group-item"><a href="namespacevrtree.html">vrtree</a></span><span class="list-group-item"><a href="namespacevrtree__cpp.html">vrtree_cpp</a></span><span class="list-group-item"><a href="namespacevt_core.html">vtCore</a></span><span class="list-group-item"><a href="group__api__core.html">Core</a></span><span class="list-group-item"><a href="group__api__ffi.html">Foreign Function Interface</a></span><span class="list-group-item"><a href="#side_group__api__metanodes" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="group__api__metanodes.html">Metanodes</a></span><div class="list-group collapse" id="side_group__api__metanodes"><span class="list-group-item"><a href="group__api__metanodes__general.html">General</a></span><span class="list-group-item"><a href="group__api__metanodes__properties.html">Properties</a></span><span class="list-group-item"><a href="group__api__metanodes__semantics.html">Semantics and Hints</a></span><span class="list-group-item"><a href="group__api__metadefs.html">Metanode Structure Definitions</a></span></div><span class="list-group-item"><a href="group__api__migrations.html">Migrations</a></span><span class="list-group-item"><a href="group__api__observer.html">Observers</a></span><span class="list-group-item"><a href="group__api__properties.html">Properties</a></span><span class="list-group-item"><a href="group__api__settings.html">Settings</a></span><span class="list-group-item"><a href="group__api__tree.html">Tree</a></span><span class="list-group-item"><a href="group__api__utils.html">Utilities</a></span><span class="list-group-item"><a href="#side_group__api__defs" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="group__api__defs.html">API Definitions</a></span><div class="list-group collapse" id="side_group__api__defs"><span class="list-group-item"><a href="group__api__types.html">Types</a></span><span class="list-group-item"><a href="group__api__proto.html">Function Prototypes</a></span><span class="list-group-item"><a href="group__api__flags.html">Flags</a></span><span class="list-group-item"><a href="group__api__io__flags.html">Save/Load Tree I/O Flags</a></span><span class="list-group-item"><a href="group__api__builder__flags.html">Build Filter flags</a></span><span class="list-group-item"><a href="group__api__loggingmask.html">Logging masks</a></span><span class="list-group-item"><a href="group__api__errors.html">Error codes</a></span></div><span class="list-group-item"><a href="group__api__exchange.html">VR Exchange</a></span><span class="list-group-item"><a href="#side_group__api__plugins" data-toggle="collapse"><i class="fas fa-plus-square list-toggle"></i></a><a href="group__api__plugins.html">Plugins</a></span><div class="list-group collapse" id="side_group__api__plugins"><span class="list-group-item"><a href="group__api__plugin__interface.html">Plugin Interface</a></span><span class="list-group-item"><a href="group__api__plugin__utils.html">Plugin Utilities</a></span></div><span class="list-group-item"><a href="group__api__lua.html">Lua API</a></span></div></div>
</div></div></body></html>